@page "/myprofile"
@inject IJSRuntime JSRuntime
@inject NavigationManager NavigationManager

<h3>My Profile</h3>

@if (isLoggedIn)
{
    <p>Welcome to your profile page!</p>
    <p>This page is accessible because you are logged in.</p>
    <p>Username: @username</p>
    <p>Your Ads: @ads</p>
    <p>Your Purchases: @purchases</p>
}
else
{
    <p>You are not logged in. Please <a href="/login">click here to log in</a>.</p>
}

@code {
    private bool isLoggedIn = false;
    private string username = "Default User";
    private string ads = "No ads listed.";
    private string purchases = "No purchases made.";

    protected override async Task OnInitializedAsync()
    {
        var isLoggedInStr = await JSRuntime.InvokeAsync<string>("localStorage.getItem", "isLoggedIn");
        isLoggedIn = isLoggedInStr != null && isLoggedInStr.Equals("true", StringComparison.OrdinalIgnoreCase);

        if (isLoggedIn)
        {
            username = await JSRuntime.InvokeAsync<string>("localStorage.getItem", "username") ?? "Default User";
            ads = await JSRuntime.InvokeAsync<string>("localStorage.getItem", "ads") ?? "No ads listed.";
            purchases = await JSRuntime.InvokeAsync<string>("localStorage.getItem", "purchases") ?? "No purchases made.";
        }
    }
}
